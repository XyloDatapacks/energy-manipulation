execute if score #xem.spell.run.getters.position.ray_trace.blocks xem.op matches 1 if score #xem.spell.run.getters.position.ray_trace.loop xem.op matches 1.. positioned ^ ^ ^0.02 unless block ~ ~ ~ #xylo_library:no_hitbox run function energy_manipulation:spell/run/getters/position/ray_trace/apply_position
execute if score #xem.spell.run.getters.position.ray_trace.blocks xem.op matches 1 if score #xem.spell.run.getters.position.ray_trace.loop xem.op matches 1.. positioned ^ ^ ^0.04 unless block ~ ~ ~ #xylo_library:no_hitbox run function energy_manipulation:spell/run/getters/position/ray_trace/apply_position
execute if score #xem.spell.run.getters.position.ray_trace.blocks xem.op matches 1 if score #xem.spell.run.getters.position.ray_trace.loop xem.op matches 1.. positioned ^ ^ ^0.06 unless block ~ ~ ~ #xylo_library:no_hitbox run function energy_manipulation:spell/run/getters/position/ray_trace/apply_position
execute if score #xem.spell.run.getters.position.ray_trace.blocks xem.op matches 1 if score #xem.spell.run.getters.position.ray_trace.loop xem.op matches 1.. positioned ^ ^ ^0.08 unless block ~ ~ ~ #xylo_library:no_hitbox run function energy_manipulation:spell/run/getters/position/ray_trace/apply_position
execute unless score #xem.spell.run.getters.position.ray_trace.loop xem.op matches 1.. run return 1

execute if score #xem.spell.run.getters.position.ray_trace.entities xem.op matches 1 positioned ~-0.25 ~-0.25 ~-0.25 as @e[type=!#xylo_library:non_interactive,dy=0,tag=!xem.spell.run.getters.position.ray_trace.ignore,tag=!xlib.non_interactive] positioned ~-0.5 ~-0.5 ~-0.5 if entity @s[dy=0] positioned ~0.75 ~0.75 ~0.75 run function energy_manipulation:spell/run/getters/position/ray_trace/apply_position
execute unless score #xem.spell.run.getters.position.ray_trace.loop xem.op matches 1.. run return 1

execute if score #xem.spell.run.getters.position.ray_trace.loop xem.op matches 1 run function energy_manipulation:spell/run/getters/position/ray_trace/apply_position
scoreboard players remove #xem.spell.run.getters.position.ray_trace.loop xem.op 1
execute if score #xem.spell.run.getters.position.ray_trace.loop xem.op matches 1.. positioned ^ ^ ^0.1 run function energy_manipulation:spell/run/getters/position/ray_trace/loop